<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${topic.title}">Topic</title>
</head>
<body>
<div class="header">
    <h1 th:text="${topicCreator.username}">Created by</h1>
</div>

<div class="topic">
    <h2 th:text="${topic.title}">Topic details</h2>
    <p><strong>Category:</strong> <span th:text="${topic.category}"></span></p>
    <p><strong>Content:</strong> <span th:text="${topic.content}"></span></p>
    <p><strong>Likes:</strong> <span th:text="${topic.likes}"></span></p>
    <p><strong>Dislikes:</strong> <span th:text="${topic.dislikes}"></span></p>
    <p><strong>Created at:</strong> <span th:text="${#dates.format(topic.createdAt, 'yyyy-MM-dd HH:mm:ss')}"></span></p>
    <div th:if="${loggedIn}">
        <div class="buttons">
            <form method="post" style="display: inline;">
                <input type="hidden" name="topicId" th:value="${topic.id}" />
                <button type="submit" name="action" value="like">Like</button>
            </form>

            <form method="post" style="display: inline;">
                <input type="hidden" name="topicId" th:value="${topic.id}" />
                <button type="submit" name="action" value="dislike">Dislike</button>
            </form>
        </div>
    </div>
    <div class="comments">
        <h3>Comments:</h3>
        <ul>
            <li th:each="comment : ${comments}">
                <p><strong th:text="${comment.createdBy.username}">Username</strong>:</p>
                <p th:text="${comment.content}">Comment</p>
                <p>Likes: <span th:text="${comment.likes}">0</span></p>
                <p>Dislikes: <span th:text="${comment.dislikes}">0</span></p>
                <div th:if="${loggedIn}">
                <div class="comment-buttons">
                    <form action="/comment" method="post" style="display: inline;">
                        <input type="hidden" name="action" value="likeComm" />
                        <input type="hidden" name="commentId" th:value="${comment.id}" />
                        <input type="hidden" name="topicId" th:value="${topic.id}" />
                        <button type="submit">Like</button>
                    </form>
                    <form action="/comment" method="post" style="display: inline;">
                        <input type="hidden" name="action" value="dislikeComm" />
                        <input type="hidden" name="commentId" th:value="${comment.id}" />
                        <input type="hidden" name="topicId" th:value="${topic.id}" />
                        <button type="submit">Dislike</button>
                    </form>
                </div>
                </div>
            </li>
        </ul>
    </div>
    <div th:if="${loggedIn}">
        <div class="add-comment">
            <h3>Add comment</h3>
            <form action="/comment" method="post" style="margin-top: 20px;">
                <input type="hidden" name="topicId" th:value="${topic.id}" />
                <textarea name="commentContent" rows="4" cols="50" placeholder="Enter your comment" required></textarea>
                <br>
                <button type="submit" name="action" value="addComment">Отправить</button>
            </form>

        </div>
    </div>
</div>
</body>
</html>
